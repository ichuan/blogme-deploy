(this["webpackJsonpblogme-ui"]=this["webpackJsonpblogme-ui"]||[]).push([[1],{13:function(e,t,a){"use strict";var n=a(28),c=function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"top-center";n.toast({message:e,type:t,position:a})};t.a={info:function(e){return c(e,"is-info")},success:function(e){return c(e,"is-success")},warning:function(e){return c(e,"is-warning")},error:function(e){return c(e,"is-danger")}}},21:function(e,t,a){"use strict";var n=a(19),c=a(0),r=a.n(c);t.a=function(e){var t=e.items,a=e.curParams,c=e.onClick,i=e.limit,l=e.idKey;i=parseInt(i||a.limit||10,10),l=l||"id";var o,s=(o=c,function(e){o(e),window.scrollTo(0,0)});if(!t||!t.length&&!a.starting_after)return"";var u=a.ending_before||t.length===i,m=a.starting_after||a.ending_before&&t.length===i,d=Math.min.apply(Math,Object(n.a)(t.map((function(e){return e[l]})))),f=Math.max.apply(Math,Object(n.a)(t.map((function(e){return e[l]}))));return r.a.createElement("nav",{className:"pagination is-centered",role:"navigation","aria-label":"pagination"},r.a.createElement("ul",{className:"pagination-list"},r.a.createElement("li",null,r.a.createElement("button",{className:"button pagination-link",disabled:!m,onClick:function(){return s({limit:i,ending_before:f})}},"\u4e0a\u4e00\u9875")),r.a.createElement("li",null,r.a.createElement("button",{className:"button pagination-link",disabled:!u,onClick:function(){return s({limit:i,starting_after:d})}},"\u4e0b\u4e00\u9875"))))}},32:function(e,t,a){e.exports=a(50)},38:function(e,t,a){},39:function(e,t,a){},48:function(e,t,a){},49:function(e,t,a){},5:function(e,t,a){"use strict";var n=a(27),c=window.localStorage.getItem("token"),r=window._API_BASE,i=/https?:\/\/[^/]+/i.exec(r)[0],l=function(e){c=e,window.localStorage.setItem("token",e)},o={401:[function(){return l("")}]};t.a={onStatus:function(e,t,a){if(o[e]||(o[e]=[]),a){t.__osid=a;var n=!0,c=!1,r=void 0;try{for(var i,l=o[e][Symbol.iterator]();!(n=(i=l.next()).done);n=!0){if(i.value.__osid===a)return}}catch(s){c=!0,r=s}finally{try{n||null==l.return||l.return()}finally{if(c)throw r}}}o[e].push(t)},fetch:function(e,t,a){var i={headers:c?{Authorization:"Bearer ".concat(c)}:{},method:e};return!a||"POST"!==e&&"PUT"!==e||(i.body=a,a instanceof FormData||(i.body=JSON.stringify(a),i.headers["Content-Type"]="application/json")),Object(n.a)("".concat(r).concat(t),i).then((function(e){if(o[e.status]){var t=!0,a=!1,n=void 0;try{for(var c,r=o[e.status][Symbol.iterator]();!(t=(c=r.next()).done);t=!0){(0,c.value)(e)}}catch(l){a=!0,n=l}finally{try{t||null==r.return||r.return()}finally{if(a)throw n}}}var i=e.json();return e.ok?i:i.then((function(e){return Promise.reject(e.detail||e)}))}))},get:function(e,t){return t&&(t=Object.keys(t).map((function(e){return"".concat(e,"=").concat(t[e])})).join("&"),e="".concat(e,"?").concat(t)),this.fetch("GET",e)},post:function(e,t){return this.fetch("POST",e,t)},put:function(e,t){return this.fetch("PUT",e,t)},delete:function(e){return this.fetch("DELETE",e)},login:function(e,t,a){var n=new FormData;return n.append("username",t),n.append("password",a),this.post(e,n).then((function(e){return e&&e.access_token&&l(e.access_token),e}))},logout:function(){l("")},upload:function(e,t,a){return new Promise((function(n,l){var o=new FormData,s=new XMLHttpRequest,u=r+e;o.append("file",t),s.open("POST",u,!0),s.setRequestHeader("Authorization","Bearer ".concat(c)),s.upload.addEventListener("progress",(function(e){a&&a(e.loaded/e.total*100)})),s.addEventListener("load",(function(e){if(s.readyState===s.DONE)try{var t=JSON.parse(s.responseText);200===s.status?n({url:"".concat(i).concat(t.url)}):l(t.detail||t)}catch(e){l(e)}})),s.send(o)}))},hasToken:function(){return c}}},50:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(25),i=a.n(r),l=(a(37),a(38),a(3)),o=a(4),s=a(10),u=a(9),m=a(5),d=a(13),f=function(e){var t=e.isActive,a=e.onClose,r=e.onLoggedin,i=Object(n.useState)(""),o=Object(l.a)(i,2),s=o[0],u=o[1],f=Object(n.useState)(""),b=Object(l.a)(f,2),E=b[0],h=b[1],v=Object(n.useRef)(null),p=function(){(function(e,t){return e&&t?m.a.login("/users/access-token",e,t).then((function(e){return m.a.post("/users/test-token")})):Promise.reject("\u8bf7\u586b\u5199\u5b8c\u6574")})(s,E).then((function(e){d.a.success("\u767b\u5f55\u6210\u529f"),r(e)})).catch(d.a.error)};return Object(n.useEffect)((function(){t&&v.current&&v.current.focus()}),[t]),c.a.createElement("div",{className:"modal login ".concat(t?"is-active":"")},c.a.createElement("div",{className:"modal-background"}),c.a.createElement("div",{className:"modal-content"},c.a.createElement("div",{className:"box"},c.a.createElement("h1",{className:"title has-text-centered"},"\u767b\u5f55"),c.a.createElement("form",null,c.a.createElement("div",{className:"field"},c.a.createElement("label",{className:"label"},"\u7528\u6237\u540d"),c.a.createElement("div",{className:"control"},c.a.createElement("input",{className:"input",type:"text",ref:v,onChange:function(e){return u(e.target.value)}}))),c.a.createElement("div",{className:"field"},c.a.createElement("label",{className:"label"},"\u5bc6\u7801"),c.a.createElement("div",{className:"control"},c.a.createElement("input",{className:"input",type:"password",onChange:function(e){return h(e.target.value)},onKeyPress:function(e){return 13===e.charCode&&p()}}))),c.a.createElement("div",{className:"field is-grouped"},c.a.createElement("div",{className:"control"},c.a.createElement("button",{type:"button",className:"button is-link",onClick:p},"\u767b\u5f55")),c.a.createElement("div",{className:"control"},c.a.createElement("button",{type:"button",className:"button is-link is-light",onClick:a},"\u53d6\u6d88")))))),c.a.createElement("button",{type:"button",className:"modal-close is-large",onClick:a}))},b=function(e){var t=e.className,a=e.href,n=e.children,r=e.onClick,i={href:"#"};return t&&(i.className=t),a&&(i.href=a),i.onClick=r?function(e){e.preventDefault(),r(e)}:function(e){return e.preventDefault()},c.a.createElement("a",i,n)},E=(a(39),function(){var e=Object(u.a)(),t=Object(l.a)(e,2),a=t[0],r=t[1],i=Object(n.useState)(!1),E=Object(l.a)(i,2),h=E[0],v=E[1],p=Object(n.useState)(!1),g=Object(l.a)(p,2),N=g[0],j=g[1],O=Object(s.f)();return c.a.createElement("section",{className:"hero header is-info is-medium",style:a.config["site.header-bg"]?{backgroundImage:"linear-gradient(rgba(0, 0, 0, 0.1), rgba(0, 0, 0, 0.2)),url(".concat(a.config["site.header-bg"],")")}:{}},c.a.createElement("div",{className:"hero-head"},c.a.createElement("nav",{className:"navbar is-info"},c.a.createElement("div",{className:"container"},c.a.createElement("div",{className:"navbar-brand"},c.a.createElement(b,{className:"navbar-burger burger ".concat(h?"is-active":""),onClick:function(){return v(!h)}},c.a.createElement("span",{"aria-hidden":"true"}),c.a.createElement("span",{"aria-hidden":"true"}),c.a.createElement("span",{"aria-hidden":"true"}))),c.a.createElement("div",{className:"navbar-menu ".concat(h?"is-active":"")},c.a.createElement("div",{className:"navbar-end"},a.user?c.a.createElement(c.a.Fragment,null,c.a.createElement(o.c,{className:"navbar-item",to:"/new",activeClassName:"is-active",onClick:function(){return v(!1)}},"\u53d1\u5e03"),c.a.createElement("div",{className:"navbar-item has-dropdown is-hoverable"},c.a.createElement(b,{className:"navbar-link"},"\u7ba1\u7406"),c.a.createElement("div",{className:"navbar-dropdown is-right"},c.a.createElement(o.c,{className:"navbar-item",to:"/admin/article",activeClassName:"is-active",onClick:function(){return v(!1)}},"\u6587\u7ae0"),c.a.createElement(o.c,{className:"navbar-item",to:"/admin/user",activeClassName:"is-active",onClick:function(){return v(!1)}},"\u7528\u6237"),c.a.createElement(o.c,{className:"navbar-item",to:"/admin/site",activeClassName:"is-active",onClick:function(){return v(!1)}},"\u7f51\u7ad9"))),c.a.createElement(b,{className:"navbar-item",onClick:function(){m.a.logout(),r.setUser(null),O.push("/"),d.a.success("\u5df2\u9000\u51fa\u767b\u5f55"),v(!1)}},"\u9000\u51fa")):c.a.createElement(b,{className:"navbar-item",onClick:function(){v(!1),j(!0)}},"\u767b\u5f55")))))),c.a.createElement("div",{className:"hero-body"},c.a.createElement("div",{className:"container has-text-centered"},c.a.createElement("h1",{className:"title"},c.a.createElement(o.b,{to:"/"},a.config["site.name"])),c.a.createElement("h2",{className:"subtitle"},a.config["site.desc"]))),c.a.createElement(f,{isActive:N,onClose:function(){return j(!1)},onLoggedin:function(e){j(!1),r.setUser(e)}}))}),h=function(){var e=(new Date).getFullYear(),t=window.location.hostname;return c.a.createElement("footer",{className:"footer"},c.a.createElement("div",{className:"content has-text-centered"},c.a.createElement("p",null,"\xa9 ",e," ",t," \xb7"," ",c.a.createElement(o.b,{to:"/archive",className:"has-text-grey-dark"},"\u6587\u7ae0\u7d22\u5f15"))))},v=a(14),p=a(12),g=(a(48),a(31),function(e){var t=e.item,a=Object(n.useState)(t||{}),r=Object(l.a)(a,2),i=r[0],d=r[1],f=Object(u.a)()[0],b=!1,E=i.created_at?i.created_at.split("T")[0]:"-";if(!t){b=!0;var h=Object(s.g)().articleId;Object(n.useEffect)((function(){m.a.get("/articles/".concat(h)).then((function(e){return d(e)}))}),[h])}return c.a.createElement("div",{className:"article"},b&&i.id&&c.a.createElement(v.Helmet,null,c.a.createElement("title",null,"".concat(i.subject," - ").concat(f.config["site.name"]))),c.a.createElement("h1",{className:"title"},b?i.subject:c.a.createElement(o.b,{to:"/p/".concat(i.id)},i.subject)),c.a.createElement("div",{className:"content trix-content",dangerouslySetInnerHTML:{__html:i.content||""}}),c.a.createElement("ul",{className:"meta"},c.a.createElement("li",{title:i.username},c.a.createElement(p.d,{icon:p.c}),i.display_name||i.username),c.a.createElement("li",{title:i.created_at},c.a.createElement(p.d,{icon:p.a}),E),f.user&&(f.user.id===i.user_id||f.user.is_superuser)&&c.a.createElement("li",null,c.a.createElement(o.b,{to:"/edit/".concat(i.id)},c.a.createElement(p.d,{icon:p.b}),"\u7f16\u8f91"))))}),N=a(21),j=function(){var e=Object(u.a)()[0],t=Object(s.f)(),a=Object(n.useState)([]),r=Object(l.a)(a,2),i=r[0],o=r[1],d=Object(s.g)().encodedParams,f={};try{f=JSON.parse(window.atob(d))}catch(b){}return Object(n.useEffect)((function(){m.a.get("/articles",f).then((function(e){return o(e)}))}),[f.starting_after,f.ending_before,f.limit]),c.a.createElement("div",{className:"container"},c.a.createElement(v.Helmet,null,c.a.createElement("title",null,"\u9996\u9875 - ".concat(e.config["site.name"]||""))),i.map((function(e){return c.a.createElement(g,{item:e,key:e.id})})),c.a.createElement(N.a,{items:i,curParams:f,onClick:function(e){return t.push("/_/".concat(window.btoa(JSON.stringify(e))))}}))},O=(a(49),Object(n.lazy)((function(){return Promise.all([a.e(0),a.e(7)]).then(a.bind(null,53))}))),y=Object(n.lazy)((function(){return Promise.all([a.e(0),a.e(5)]).then(a.bind(null,58))})),k=Object(n.lazy)((function(){return a.e(6).then(a.bind(null,59))})),w=Object(n.lazy)((function(){return a.e(9).then(a.bind(null,62))})),C=Object(n.lazy)((function(){return a.e(8).then(a.bind(null,60))})),_=Object(n.lazy)((function(){return a.e(4).then(a.bind(null,61))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(c.a.createElement((function(){var e=Object(u.a)(),t=Object(l.a)(e,2),a=t[0],r=t[1];return Object(n.useEffect)((function(){m.a.get("/config").then((function(e){return r.setConfig(e)})),m.a.hasToken()&&!a.user&&m.a.post("/users/test-token").then((function(e){e.username&&r.setUser(e)}))}),[r]),c.a.createElement(o.a,null,c.a.createElement("div",{className:"App"},c.a.createElement(E,null),c.a.createElement(n.Suspense,{fallback:c.a.createElement("progress",{className:"progress is-small is-primary",max:"100"})},c.a.createElement(s.c,null,c.a.createElement(s.a,{exact:!0,path:"/edit/:articleId",component:y}),c.a.createElement(s.a,{exact:!0,path:"/new",component:O}),c.a.createElement(s.a,{exact:!0,path:"/admin/article",component:k}),c.a.createElement(s.a,{exact:!0,path:"/admin/user",component:w}),c.a.createElement(s.a,{exact:!0,path:"/admin/site",component:C}),c.a.createElement(s.a,{exact:!0,path:"/archive",component:_}),c.a.createElement(s.a,{exact:!0,path:"/p/:articleId"},c.a.createElement("div",{className:"container"},c.a.createElement(g,null))),c.a.createElement(s.a,{exact:!0,path:["/_/:encodedParams","/"]},c.a.createElement(j,null)))),c.a.createElement(h,null)))}),null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},9:function(e,t,a){"use strict";var n=a(0),c=a.n(n),r=a(26);t.a=Object(r.a)(c.a,{config:{},user:null},{setConfig:function(e,t){e.setState({config:t})},setUser:function(e,t){e.setState({user:t})}})}},[[32,2,3]]]);
//# sourceMappingURL=main.8fa0cf8c.chunk.js.map