(this["webpackJsonpblogme-ui"]=this["webpackJsonpblogme-ui"]||[]).push([[5,7],{54:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(0),r=n.n(c),i=n(10),l=n(15),o=n(23),u=n(5),s=(n(53),n(34),r.a.forwardRef((function(e,t){var n=e.value,a=e.onChange,i=e.onUploadStart,l=e.onUploadEnd,s="input-".concat(+new Date);return Object(c.useEffect)((function(){var e=function(e){e.attachment.file&&(i&&i(),u.a.upload("/articles/upload",e.attachment.file,(function(t){return e.attachment.setUploadProgress(t)})).then((function(t){e.attachment.setAttributes(Object(o.a)({url:t.url,href:t.url},/(jpe?g|png|gif)$/i.test(t.url)?{filesize:null,filename:null}:{}))})).finally((function(e){l&&l()})))};return window.addEventListener("trix-attachment-add",e),function(){window.removeEventListener("trix-attachment-add",e)}}),[i,l]),Object(c.useEffect)((function(){var e=function(e){return a(e.target.value)};return window.addEventListener("trix-change",e),function(){window.removeEventListener("trix-change",e)}}),[a]),r.a.createElement("div",null,r.a.createElement("input",{id:s,type:"hidden",name:"content",value:n}),r.a.createElement("trix-editor",{ref:t,input:s,class:"content is-trix"}))}))),f=n(11),d={_key:"bm.draft",get:function(){var e=window.localStorage.getItem(this._key);return e?JSON.parse(e):""},set:function(e){return window.localStorage.setItem(this._key,JSON.stringify(e))},remove:function(){return window.localStorage.removeItem(this._key)}};t.default=function(e){var t=e.item,n=void 0===t?{}:t,o=Object(c.useState)(n.subject||""),m=Object(a.a)(o,2),b=m[0],v=m[1],E=Object(c.useState)(n.content||""),p=Object(a.a)(E,2),h=p[0],j=p[1],g=Object(c.useRef)(null),O=Object(c.useState)(!1),w=Object(a.a)(O,2),N=w[0],S=w[1],y=Object(i.f)();return Object(c.useEffect)((function(){var e=d.get();!n.id&&e&&(window.confirm("\u53d1\u73b0\u6709\u4e4b\u524d\u672a\u4fdd\u5b58\u7684\u8349\u7a3f\uff0c\u662f\u5426\u6062\u590d\uff1f")?(v(e.subject),j(e.content),g.current.editor.loadJSON(e.state)):d.remove())}),[n.id]),Object(c.useEffect)((function(){!n.id&&b&&h&&d.set({subject:b,content:h,state:g.current.editor})}),[n.id,b,h]),r.a.createElement("div",{className:"container editor"},r.a.createElement(l.Helmet,null,r.a.createElement("title",null,"".concat(n.id?"\u7f16\u8f91":"\u53d1\u5e03","\u6587\u7ae0"))),r.a.createElement("form",null,r.a.createElement("div",{className:"has-text-right"},r.a.createElement("button",{type:"button",className:"button is-info ".concat(N?"is-loading":""),onClick:function(){S(!0),function(e,t,n){if(!e)return Promise.reject("\u8bf7\u8f93\u5165\u6807\u9898");var a={subject:e,content:t};return n?u.a.put("/articles/".concat(n),a):u.a.post("/articles",a)}(b,h,n.id).then((function(e){f.a.success("\u4fdd\u5b58\u6210\u529f"),d.remove(),y.push("/p/".concat(e.id||n.id))})).catch(f.a.error).finally((function(e){return S(!1)}))}},n.id?"\u4fdd\u5b58":"\u53d1\u5e03")),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"\u6807\u9898"),r.a.createElement("div",{className:"control"},r.a.createElement("input",{className:"input",type:"text",value:b,onChange:function(e){return v(e.target.value)}}))),r.a.createElement("div",{className:"field"},r.a.createElement("label",{className:"label"},"\u6b63\u6587"),r.a.createElement("div",{className:"control"},r.a.createElement(s,{ref:g,value:h,onChange:j,onUploadStart:function(){return S(!0)},onUploadEnd:function(){return S(!1)}})))))}},59:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n(0),r=n.n(c),i=n(10),l=n(54),o=n(5),u=n(14);t.default=function(){var e=Object(i.g)().articleId,t=Object(c.useState)({}),n=Object(a.a)(t,2),s=n[0],f=n[1],d=Object(c.useState)(!1),m=Object(a.a)(d,2),b=m[0],v=m[1];return Object(c.useEffect)((function(){o.a.get("/articles/".concat(e)).then((function(e){return f(e)})).finally((function(e){return v(!0)}))}),[e]),b?r.a.createElement(l.default,{item:s}):r.a.createElement("div",{className:"container"},r.a.createElement(u.a,null))}}}]);
//# sourceMappingURL=5.e3ea0351.chunk.js.map